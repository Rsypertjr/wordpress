!function(e){e.blockUI.defaults=e.extend(e.blockUI.defaults,{message:"Loading ...",css:{padding:0,margin:0,width:"100%",top:"50%",left:"0%",textAlign:"center",color:"#000",border:"none",backgroundColor:"transparent",cursor:"default",fontSize:"16px",lineHeight:"24px",height:"24px",marginTop:"-12px"},overlayCSS:{backgroundColor:"#f9f9fa",opacity:.6,cursor:"default"}}),window.top==window.self&&(window.top.location.href=wp_paint_meta.wp_admin_url),window.wpp_enable_color_memory=function(){window.MP_GUI.GUI_colors._change_color=window.MP_GUI.GUI_colors.change_color,window.MP_GUI.GUI_colors.change_color=function(e,o,i,t){window.MP_GUI.GUI_colors._change_color(e,o,i,t),window.MP_GUI.Helper.setCookie("selected_color",e)}},window.wpp_open_url=function(o,i){if(""!=o){if(void 0===i)i=window.State.Base_layers;var t=o.replace(/^.*[\\\/]/,""),n=new Image;n.crossOrigin="Anonymous",n.onload=function(){var o=n.width,a=n.height;if(n.width>wp_paint_meta.max_width||n.height>wp_paint_meta.max_height){var _=n.width/n.height;_>1?(o=wp_paint_meta.max_width,(a=Math.round(wp_paint_meta.max_width/_))>Number(wp_paint_meta.max_height)&&(a=wp_paint_meta.max_height,o=Math.round(wp_paint_meta.max_height*_))):(a=wp_paint_meta.max_height,(o=Math.round(_*wp_paint_meta.max_height))>Number(wp_paint_meta.max_width)&&(o=wp_paint_meta.max_width,a=Math.round(wp_paint_meta.max_width/_)))}var r={name:t,type:"image",link:n,width:o,height:a,width_original:n.width,height_original:n.height};i.insert(r),i.autoresize(o,a),e("#wpp-loading").remove()},n.onerror=function(e){alertify.error("Sorry, image could not be loaded. Try copy image and paste it.")},n.src=o}},window.addEventListener("load",function(o){window.MP_GUI.load_modules(),window.MP_GUI.load_default_values(),null==window.MP_GUI.Helper.getCookie("toggle_info")&&window.MP_GUI.Helper.setCookie("toggle_info",0),null==window.MP_GUI.Helper.getCookie("toggle_colors")&&window.MP_GUI.Helper.setCookie("toggle_colors",0),null==window.MP_GUI.Helper.getCookie("toggle_details")&&window.MP_GUI.Helper.setCookie("toggle_details",0);var i=window.MP_GUI.Helper.getCookie("selected_color");AppConfig.COLOR=i&&i.match(/^#((0x){0,1}|#{0,1})([0-9A-F]{8}|[0-9A-F]{6})$/gi)?i:"#333333",AppConfig.TRANSPARENCY=!0,AppConfig.TOOLS=AppConfig.TOOLS.filter(function(e){return-1==["media","animation","clone"].indexOf(e.name)}),AppConfig.themes=["light","dark","green"],window.MP_GUI.render_main_gui(),window.MP_Layers.init(),wp_paint_meta&&wp_paint_meta.attachment_url&&window.wpp_open_url(wp_paint_meta.attachment_url),window.wpp_enable_color_memory(),AppConfig.mp_version=wp_paint_meta.wpp_version,e("#wpp-save-image-button").on("click",function(){var o=document.createElement("canvas"),i=o.getContext("2d"),t=window.MP_Layers.get_dimensions(),n=t.width,a=t.height;o.width=n,o.height=a,window.MP_Layers.convert_layers_to_canvas(i),e("#wpp-image-data").val(o.toDataURL()),e("#wpp-save-image-form").submit()}),e("#wpp-save-image-form").on("submit",function(){e.blockUI({message:"Please wait ... Saving Image ..."})}),e("#wpp-restore-image-form").on("submit",function(){e.blockUI({message:"Please wait ... Restoring Original Image ..."})})},!1)}(jQuery);
